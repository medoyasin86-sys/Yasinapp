<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Y.Karizma - Tactical Whiteout</title>

    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <style>
        :root {
            --ff-gold: #d4a017; 
            --ff-light-bg: #f4f7f6;
            --ff-card: #ffffff;
            --text-main: #2d3436;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background: #dfe6e9;
            margin: 0;
            display: flex;
            justify-content: center;
            color: var(--text-main);
        }

        .battle-container {
            width: 100%;
            max-width: 450px;
            background: var(--ff-light-bg);
            min-height: 100vh;
            border: 1px solid #ccc;
            padding-bottom: 40px;
        }

        .warrior-header {
            width: 100%;
            height: 350px;
            position: relative;
            background: url('https://w0.peakpx.com/wallpaper/406/339/wallpaper-free-fire-warrior-with-gun-thumbnail.jpg') center top/cover no-repeat;
            display: flex;
            align-items: flex-end;
            border-bottom: 4px solid var(--ff-gold);
        }

        .player-info { padding: 20px; }
        .rank-tag { background: #d63031; color: white; padding: 3px 10px; font-size: 11px; font-weight: 900; }
        .player-name { font-size: 38px; font-weight: 900; margin: 5px 0; }

        /* Ø§Ù„Ø¹Ø¨Ø§Ø±Ø© Ø§Ù„Ø­Ù…Ø±Ø§Ø¡ */
        .disappointed-text {
            color: #b30000;
            font-weight: 900;
            margin-top: -8px;
            font-size: 15px;
        }

        /* Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø© */
        #reward-warning {
            background:#ffe6e6;
            border:2px solid #ff1a1a;
            color:#8b0000;
            padding:15px;
            margin:15px;
            border-radius:10px;
            font-weight:900;
            line-height:1.8;
            font-size:13px;
        }

        .loot-card {
            background: var(--ff-card);
            margin: 0 15px 15px 15px;
            padding: 15px;
            border-radius: 12px;
            text-align: center;
        }

        .bounty-amount {
            font-size: 40px;
            font-weight: 900;
            color: var(--ff-gold);
        }

        .date-shifter {
            display: flex;
            justify-content: space-between;
            margin: 0 15px;
            padding: 8px;
            border: 1px solid #ddd;
            background: #fff;
            border-radius: 8px;
        }

        .shift-btn {
            width: 40px;
            height: 40px;
            font-size: 20px;
            border: 1px solid #ddd;
            cursor: pointer;
            background: #f0f0f0;
        }

        .date-display {
            flex: 1;
            text-align: center;
            font-weight: 900;
            cursor: pointer;
        }

        .battle-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 15px;
        }

        .action-btn {
            padding: 15px;
            font-size: 18px;
            font-weight: 900;
            border: none;
            cursor: pointer;
        }

        .btn-booyah { background: var(--ff-gold); color: #fff; }
        .btn-defeat { background: #f0f0f0; color: #aaa; }

        .squad-radio-container {
            background: #fff;
            margin: 15px;
            border-radius: 10px;
            border: 1px solid #ddd;
            overflow: hidden;
        }

        .radio-header {
            background: #f8f9fa;
            padding: 8px;
            font-size: 12px;
            font-weight: 900;
            color: #c00;
        }

        .chat-box {
            height: 180px;
            overflow-y: auto;
            padding: 10px;
        }

        .msg {
            background: #fff3f3;
            border-right: 3px solid #ff6666;
            padding: 8px;
            border-radius: 6px;
            margin-bottom: 6px;
            color: #900;
            font-size: 12px;
        }

        .chat-input-area {
            display: flex;
            padding: 8px;
            background: #f8f9fa;
            border-top: 1px solid #eee;
        }

        .msg-input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
        }

        .btn-send {
            background: #ff1a1a;
            color: white;
            border: none;
            padding: 0 15px;
            margin-right: 5px;
            border-radius: 6px;
            cursor: pointer;
        }

        .battle-log {
            background: #fff;
            margin: 15px;
            border: 1px solid #ddd;
            border-radius: 10px;
        }

        .log-header {
            padding: 10px;
            font-size: 12px;
            font-weight: 900;
            color: var(--ff-gold);
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
        }

        .log-list {
            max-height: 150px;
            overflow-y: auto;
            padding: 10px;
        }

        input[type="date"] {
            display: none;
        }

    </style>
</head>

<body>

<div class="battle-container">

    <div class="warrior-header">
        <div class="player-info">
            <span class="rank-tag">ğŸ† GRANDMASTER ğŸ–ï¸</span>

            <h1 class="player-name">ğŸ¥· Y.KARIZMA ğŸ”«</h1>

            <!-- Ø§Ù„Ø¹Ø¨Ø§Ø±Ø© Ø§Ù„Ø­Ù…Ø±Ø§Ø¡ -->
            <p class="disappointed-text">â— Ø®Ø°Ù„Øª Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª</p>
        </div>
    </div>

    <!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø© -->
    <div id="reward-warning">
âš ï¸ Ø¥Ø´Ø¹Ø§Ø± Ø¹Ù‚ÙˆØ¨Ø©:
<br>
ØªÙ… Ø­Ø¬Ø¨ Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¨Ø³Ø¨Ø¨ Ø§Ø±ØªÙƒØ§Ø¨ Ø®Ø·Ø£ Ø³Ù„ÙˆÙƒÙŠ ÙˆØ£Ø®Ù„Ø§Ù‚ÙŠ ÙØ¸ÙŠØ¹ Ø§Ø¹ØªØ¨Ø±ØªÙ‡ Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© Ù…Ø®Ø§Ù„ÙØ© Ø¬Ø³ÙŠÙ…Ø©.
<br>
Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·ÙˆØ© Ù„ÙŠØ³Øª Ø³ÙˆÙ‰ Ø¬Ø²Ø¡ ØµØºÙŠØ± Ù…Ù† Ø³Ù„Ø³Ù„Ø© Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø¹Ù‚Ø§Ø¨ÙŠØ© Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø§Ù„Ø³Ù„ÙˆÙƒ.
<br><br>
<button onclick="requestPardon()" style="
    background:#ff1a1a;
    color:white;
    border:none;
    padding:8px 15px;
    border-radius:6px;
    cursor:pointer;
    font-weight:900;">
ğŸ” Ø·Ù„Ø¨ Ø§Ø³ØªØ¦Ù†Ø§Ù Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© (Ø¹ÙÙˆ)
</button>
    </div>

    <div class="loot-card">
        <span style="font-size:11px;color:#777;font-weight:900;">ğŸ’ STRATEGIC BOUNTY</span>
        <span class="bounty-amount" id="money">0</span>
    </div>

    <!-- Ø§Ù„ØªØ§Ø±ÙŠØ® -->
    <div class="date-shifter">
        <button class="shift-btn" onclick="changeDay(-1)">â—€</button>
        <div class="date-display" onclick="document.getElementById('date-input').showPicker()">
            <div id="date-text">ğŸ“… ØªØ­Ù…ÙŠÙ„...</div>
            <div id="status-text" style="font-size:10px;color:#aaa;">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø±ØµØ¯</div>
        </div>
        <button class="shift-btn" onclick="changeDay(1)">â–¶</button>
        <input type="date" id="date-input" onchange="setDate(this.value)">
    </div>

    <!-- Ø§Ù„Ø£Ø²Ø±Ø§Ø± -->
    <div class="battle-actions">
        <button class="action-btn btn-booyah" id="win-btn" onclick="register(true)">BOOYAH!</button>
        <button class="action-btn btn-defeat" id="loss-btn" onclick="register(false)">DEFEAT</button>
    </div>

    <!-- ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø§Ø¹ØªØ°Ø§Ø± -->
    <div class="squad-radio-container">
        <div class="radio-header">ğŸ“¡ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø§Ø¹ØªØ°Ø§Ø± - Ø§Ù„Ù…ØªØ³Ø§Ø¨Ù‚ ÙÙ‚Ø·</div>

        <div class="chat-box" id="apology-messages"></div>

        <div class="chat-input-area">
            <input type="text" id="apology-input" class="msg-input" placeholder="Ø§ÙƒØªØ¨ Ø§Ø¹ØªØ°Ø§Ø±Ùƒ Ù‡Ù†Ø§...">
            <button class="btn-send" onclick="sendApology()">ğŸ“¡</button>
        </div>
    </div>

    <!-- Ø³Ø¬Ù„ Ø§Ù„Ù…Ù‡Ø§Ù… -->
    <div class="battle-log">
        <div class="log-header">
            <span>ğŸ“œ Ø³Ø¬Ù„ Ø§Ù„Ù…Ù‡Ø§Ù…</span>
            <span id="month-stat">â›” Ù…Ø­Ø¬ÙˆØ¨</span>
        </div>
        <div class="log-list" id="history-log"></div>
    </div>

</div>

<script>

    /* Firebase */
    const firebaseConfig = {
        apiKey: "AIzaSyAPhrEzYnHoL3ln8_5BFFyWCjx2Y-G80E0",
        authDomain: "yassinapp-20262.firebaseapp.com",
        databaseURL: "https://yassinapp-20262-default-rtdb.firebaseio.com",
        projectId: "yassinapp-20262",
        storageBucket: "yassinapp-20262.firebasestorage.app",
        messagingSenderId: "940031861888",
        appId: "1:940031861888:web:9b7600cbf80b6343"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let historyData = {};
    let activeDate = new Date();


    /* Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹ÙÙˆ Ø¨Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ */
    function requestPardon() {
        const code = prompt("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ Ù„Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø©:");

        if (code === null) return;

        if (code === "9090") {
            localStorage.setItem("yassin_pardon", "true");
            document.getElementById("reward-warning").style.display = "none";
            calculateBounty();
            alert("ØªÙ… Ø§Ù„Ø¹ÙÙˆ ÙˆØ§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª.");
        } else {
            alert("âŒ Ø§Ù„Ø±Ù…Ø² ØºÙŠØ± ØµØ­ÙŠØ­.");
        }
    }


    /* Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© */
    function calculateBounty() {
        const isPardoned = localStorage.getItem("yassin_pardon") === "true";

        if (!isPardoned) {
            document.getElementById('money').innerText = "0";
            document.getElementById('month-stat').innerText = "â›” Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© Ù…Ø­Ø¬ÙˆØ¨Ø©";
            return;
        }

        // Ø­Ø³Ø§Ø¨ Ø·Ø¨ÙŠØ¹ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø¹ÙÙˆ
        let dry = 0, wet = 0, hasWet = false;

        Object.entries(historyData).forEach(([date, stat]) => {
            const d = new Date(date);
            if (
                d.getMonth() === activeDate.getMonth() &&
                d.getFullYear() === activeDate.getFullYear()
            ) {
                if (stat === "dry") dry++;
                else {
                    wet++;
                    hasWet = true;
                }
            }
        });

        const money = hasWet ? dry * 10 : 1000;

        document.getElementById("money").innerText = money;
        document.getElementById("month-stat").innerText = `âœ… ${dry} | âŒ ${wet}`;
    }


    /* ØªØ³Ø¬ÙŠÙ„ BOOYAH / DEFEAT */
    function register(isDry) {
        const key = activeDate.toISOString().split("T")[0];
        if (historyData[key]) return;

        db.ref("yassin_money_quest/history").update({
            [key]: isDry ? "dry" : "wet",
        });
    }


    /* Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„ */
    function renderLog() {
        const list = document.getElementById("history-log");
        list.innerHTML = "";

        Object.entries(historyData)
            .sort((a, b) => b[0].localeCompare(a[0]))
            .forEach(([date, stat]) => {
                list.innerHTML += `
                    <div style="padding:8px;border-bottom:1px solid #eee;display:flex;justify-content:space-between;">
                        <span>${date}</span>
                        <b style="color:${stat === "dry" ? "green" : "red"}">${stat.toUpperCase()}</b>
                    </div>
                `;
            });
    }


    /* Ø¹Ø±Ø¶ Ø§Ù„ØªØ§Ø±ÙŠØ® */
    function updateDisplay() {
        const key = activeDate.toISOString().split("T")[0];
        const options = { weekday: "long", day: "numeric", month: "long" };

        document.getElementById("date-text").innerText =
            "ğŸ“… " + activeDate.toLocaleDateString("ar-EG", options);

        document.getElementById("status-text").innerText = historyData[key]
            ? "ØªÙ… Ø§Ù„Ø±ØµØ¯"
            : "Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø±ØµØ¯";
    }


    /* ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø§Ø¹ØªØ°Ø§Ø± */
    function sendApology() {
        const text = document.getElementById("apology-input").value;
        if (!text) return;

        db.ref("apology_chat").push({
            text,
            timestamp: Date.now(),
        });

        document.getElementById("apology-input").value = "";
    }

    db.ref("apology_chat")
        .limitToLast(20)
        .on("value", (snap) => {
            const box = document.getElementById("apology-messages");
            box.innerHTML = "";

            snap.forEach((child) => {
                const m = child.val();
                box.innerHTML += `
                    <div class="msg">${m.text}</div>
                `;
            });

            box.scrollTop = box.scrollHeight;
        });


    /* ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª */
    db.ref("yassin_money_quest/history").on("value", (snap) => {
        historyData = snap.val() || {};
        calculateBounty();
        renderLog();
        updateDisplay();
    });

    document.getElementById("date-input").valueAsDate = new Date();
</script>

</body>
</html>
