<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Y.Karizma - Tactical Whiteout</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            --ff-gold: #d4a017; 
            --ff-light-bg: #f4f7f6;
            --ff-card: #ffffff;
            --heroic-red: #d63031;
            --success-green: #27ae60;
            --squad-blue: #0984e3;
            --ammo-pink: #e84393;
            --text-main: #2d3436;
        }

        body { font-family: 'Cairo', sans-serif; background: #dfe6e9; margin: 0; display: flex; justify-content: center; color: var(--text-main); overflow-x: hidden; }
        .battle-container { width: 100%; max-width: 450px; background: var(--ff-light-bg); min-height: 100vh; border: 1px solid #ccc; position: relative; padding-bottom: 40px; box-shadow: 0 0 30px rgba(0,0,0,0.1); }

        .warrior-header { width: 100%; height: 350px; position: relative; background: url('https://w0.peakpx.com/wallpaper/406/339/wallpaper-free-fire-warrior-with-gun-thumbnail.jpg') center top/cover no-repeat; display: flex; align-items: flex-end; border-bottom: 4px solid var(--ff-gold); }
        .warrior-header::after { content: ''; position: absolute; inset: 0; background: linear-gradient(to top, var(--ff-light-bg) 5%, transparent 80%); }
        .player-info { position: relative; z-index: 5; padding: 20px; width: 100%; }
        .rank-tag { background: var(--heroic-red); color: white; padding: 2px 10px; font-size: 11px; font-weight: 900; border-radius: 3px; }
        .player-name { font-size: 38px; font-weight: 900; color: #2d3436; margin: 5px 0; display: flex; align-items: center; gap: 10px; }

        /* Red warning message */
        #reward-warning {
            background:#ffe6e6;
            border:2px solid #ff1a1a;
            color:#8b0000;
            padding:15px;
            margin:15px;
            border-radius:10px;
            font-weight:900;
            line-height:1.8;
            font-size:13px;
        }

        .loot-card { background: var(--ff-card); margin: 0 15px 15px 15px; padding: 15px; border-radius: 12px; text-align: center; border: 1px solid #e0e0e0; }
        .bounty-amount { font-size: 40px; font-weight: 900; color: var(--ff-gold); display: block; }

        .date-shifter { display: flex; justify-content: space-between; align-items: center; background: #fff; margin: 0 15px 15px 15px; padding: 8px; border-radius: 8px; border: 1px solid #ddd; }
        .shift-btn { background: #f0f0f0; border: 1px solid #ddd; color: var(--ff-gold); width: 40px; height: 40px; border-radius: 5px; cursor: pointer; font-size: 18px; }
        .date-display { flex: 1; text-align: center; font-weight: 900; color: #2d3436; cursor:pointer; }

        .battle-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 0 15px 20px 15px; }
        .action-btn { padding: 15px; border: none; font-family: 'Cairo'; font-weight: 900; cursor: pointer; }
        .btn-booyah { background: var(--ff-gold); color: #fff; }
        .btn-defeat { background: #f0f0f0; color: #b2bec3; border: 1px solid #ddd; }

        .squad-radio-container { background: #fff; margin: 0 15px 20px 15px; border: 1px solid #ddd; border-radius: 10px; }
        .radio-header { background: #f8f9fa; padding: 8px; font-size: 10px; font-weight: 900; color: var(--squad-blue); border-bottom: 1px solid #ddd; }
        .chat-box { height: 180px; overflow-y: auto; padding: 10px; }
        .msg { font-size: 12px; padding: 6px 10px; border-radius: 6px; background: #f1f2f6; }

        .battle-log { background: #fff; margin: 0 15px; border-radius: 10px; border: 1px solid #ddd; }
        .log-header { padding: 10px; font-size: 12px; color: var(--ff-gold); border-bottom: 1px solid #eee; display: flex; justify-content: space-between; font-weight: bold; }
        .log-list { max-height: 150px; overflow-y: auto; padding: 5px; }
    </style>
</head>

<body>

<div class="battle-container">

    <div class="warrior-header">
        <div class="player-info">
            <span class="rank-tag">ğŸ† GRANDMASTER ğŸ–ï¸</span>
            <h1 class="player-name">ğŸ¥· Y.KARIZMA ğŸ”«</h1>
        </div>
    </div>

    <!-- RED WARNING BOX -->
    <div id="reward-warning">
âš ï¸ Ø¥Ø´Ø¹Ø§Ø± Ø¹Ù‚ÙˆØ¨Ø© ØµØ§Ø±Ù…:
<br>
ØªÙ… Ø­Ø¬Ø¨ Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¨Ø³Ø¨Ø¨ Ø§Ø±ØªÙƒØ§Ø¨ <b>Ø®Ø·Ø£ Ø³Ù„ÙˆÙƒÙŠ ÙˆØ£Ø®Ù„Ø§Ù‚ÙŠ ÙØ¸ÙŠØ¹</b> Ø§Ø¹ØªØ¨Ø±ØªÙ‡ Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© Ù…Ø®Ø§Ù„ÙØ© Ø¬Ø³ÙŠÙ…Ø©.
<br>
Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·ÙˆØ© Ù…Ø¬Ø±Ø¯ Ø¬Ø²Ø¡ ØµØºÙŠØ± Ù…Ù† Ø³Ù„Ø³Ù„Ø© Ø¹Ù‚ÙˆØ¨Ø§Øª Ø³ÙŠØªÙ… ØªÙ†ÙÙŠØ°Ù‡Ø§ Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ù‡Ø°Ø§ Ø§Ù„Ø³Ù„ÙˆÙƒ.
<br><br>
<button onclick="requestPardon()" style="
    background:#ff1a1a;
    color:white;
    border:none;
    padding:8px 15px;
    border-radius:6px;
    cursor:pointer;
    font-weight:900;">
ğŸ” Ø·Ù„Ø¨ Ø§Ø³ØªØ¦Ù†Ø§Ù Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© (Ø·Ù„Ø¨ Ø¹ÙÙˆ)
</button>
    </div>

    <div class="loot-card">
        <span style="font-size: 11px; color: #888; font-weight: bold;">ğŸ’ STRATEGIC BOUNTY</span>
        <span class="bounty-amount" id="money">0</span>
    </div>

    <div class="date-shifter">
        <button class="shift-btn" onclick="changeDay(-1)">â—€</button>
        <div class="date-display" onclick="document.getElementById('date-input').showPicker()">
            <div id="date-text">ğŸ“… ØªØ­Ù…ÙŠÙ„...</div>
            <div id="status-text" style="font-size:10px; color: #999;">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø±ØµØ¯</div>
        </div>
        <button class="shift-btn" onclick="changeDay(1)">â–¶</button>
        <input type="date" id="date-input" onchange="setDate(this.value)" style="display:none;">
    </div>

    <div class="battle-actions">
        <button class="action-btn btn-booyah" id="win-btn" onclick="register(true)">BOOYAH!</button>
        <button class="action-btn btn-defeat" id="loss-btn" onclick="register(false)">DEFEAT</button>
    </div>


    <div class="battle-log">
        <div class="log-header">
            <span>ğŸ“œ Ø³Ø¬Ù„ Ø§Ù„Ù…Ù‡Ø§Ù…</span>
            <span id="month-stat">â›” Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© Ù…Ø­Ø¬ÙˆØ¨Ø©</span>
        </div>
        <div class="log-list" id="history-log"></div>
    </div>

</div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyAPhrEzYnHoL3ln8_5BFFyWCjx2Y-G80E0",
        authDomain: "yassinapp-20262.firebaseapp.com",
        databaseURL: "https://yassinapp-20262-default-rtdb.firebaseio.com",
        projectId: "yassinapp-20262",
        storageBucket: "yassinapp-20262.firebasestorage.app",
        messagingSenderId: "940031861888",
        appId: "1:940031861888:web:9b7600cbf80b6343"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let historyData = {};
    let activeDate = new Date();

    function changeDay(delta) { activeDate.setDate(activeDate.getDate() + delta); updateDisplay(); }
    function setDate(val) { activeDate = new Date(val); updateDisplay(); }

    function register(isDry) {
        const key = activeDate.toISOString().split('T')[0];
        if(historyData[key]) return;

        db.ref('yassin_money_quest/history').update({ [key]: isDry ? 'dry' : 'wet' });
    }

    db.ref('yassin_money_quest/history').on('value', (snap) => {
        historyData = snap.val() || {};
        calculateBounty();
        renderLog();
        updateDisplay();
    });

    /* CALCULATE BOUNTY â€” WITH PARDON SYSTEM */
    function calculateBounty() {
        const isPardoned = localStorage.getItem("yassin_pardon") === "true";

        if (!isPardoned) {
            document.getElementById('money').innerText = "0";
            document.getElementById('month-stat').innerText = `â›” Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© Ù…Ø­Ø¬ÙˆØ¨Ø© Ø¨Ø³Ø¨Ø¨ Ù…Ø®Ø§Ù„ÙØ© Ø³Ù„ÙˆÙƒÙŠØ©`;
            return;
        }

        // If pardoned â†’ calculate normal
        let dry = 0, wet = 0, hasWet = false;

        Object.entries(historyData).forEach(([date, stat]) => {
            const d = new Date(date);
            if (d.getMonth() === activeDate.getMonth() && d.getFullYear() === activeDate.getFullYear()) {
                if (stat === 'dry') dry++;
                else { wet++; hasWet = true; }
            }
        });

        const isJan26 = (activeDate.getFullYear() === 2026 && activeDate.getMonth() === 0);

        document.getElementById('money').innerText =
            isJan26 ? "1000" : (hasWet ? dry * 10 : 1000);

        document.getElementById('month-stat').innerText = `âœ… ${dry} | âŒ ${wet}`;
    }

    /* LOG RENDER */
    function renderLog() {
        const list = document.getElementById('history_log');
        const keys = Object.keys(historyData || {});
        list.innerHTML = '';

        keys.sort().reverse().forEach(date => {
            list.innerHTML += `
                <div class="log-entry">
                    <span>${date}</span>
                    <b style="color:${historyData[date] === 'dry' ? 'green' : 'red'}">${historyData[date].toUpperCase()}</b>
                </div>`;
        });
    }

    /* SECRET PARDON SYSTEM â€” CODE 9090 */
    function requestPardon() {
        const code = prompt("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ Ù„Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø© ÙˆØ§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª:");

        if (code === null) return;

        if (code === "9090") {
            localStorage.setItem("yassin_pardon", "true");
            document.getElementById("reward-warning").style.display = "none";
            calculateBounty();
            alert("ØªÙ… Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù…Ø² Ø¨Ù†Ø¬Ø§Ø­. ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¹ÙÙˆ.");
        } else {
            alert("Ø§Ù„Ø±Ù…Ø² ØºÙŠØ± ØµØ­ÙŠØ­. ØªÙ… Ø±ÙØ¶ Ø·Ù„Ø¨ Ø§Ù„Ø¹ÙÙˆ.");
        }
    }

    document.getElementById('date-input').valueAsDate = new Date();
    updateDisplay();

    function updateDisplay() {
        const key = activeDate.toISOString().split('T')[0];
        const dateOptions = { weekday: 'long', day: 'numeric', month: 'long' };
        document.getElementById('date-text').innerText = "ğŸ“… " + activeDate.toLocaleDateString('ar-EG', dateOptions);
        document.getElementById('status-text').innerText =
            historyData[key] ? "ØªÙ… Ø§Ù„Ø±ØµØ¯" : "Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø±ØµØ¯";
    }
</script>

</body>
</html>
