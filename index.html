<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Y.Karizma - Tactical Whiteout</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --ff-gold: #d4a017; /* Ø°Ù‡Ø¨ÙŠ Ø£ØºÙ…Ù‚ Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ù„Ù„ÙˆØ¶ÙˆØ­ Ø¹Ù„Ù‰ Ø§Ù„ÙØ§ØªØ­ */
            --ff-light-bg: #f4f7f6;
            --ff-card: #ffffff;
            --heroic-red: #d63031;
            --success-green: #27ae60;
            --squad-blue: #0984e3;
            --ammo-pink: #e84393;
            --text-main: #2d3436;
        }

        body { font-family: 'Cairo', sans-serif; background: #dfe6e9; margin: 0; display: flex; justify-content: center; color: var(--text-main); overflow-x: hidden; }
        .battle-container { width: 100%; max-width: 450px; background: var(--ff-light-bg); min-height: 100vh; border: 1px solid #ccc; position: relative; padding-bottom: 40px; box-shadow: 0 0 30px rgba(0,0,0,0.1); }

        /* Header */
        .warrior-header { width: 100%; height: 350px; position: relative; background: url('https://w0.peakpx.com/wallpaper/406/339/wallpaper-free-fire-warrior-with-gun-thumbnail.jpg') center top/cover no-repeat; display: flex; align-items: flex-end; border-bottom: 4px solid var(--ff-gold); }
        .warrior-header::after { content: ''; position: absolute; inset: 0; background: linear-gradient(to top, var(--ff-light-bg) 5%, transparent 80%); }
        .player-info { position: relative; z-index: 5; padding: 20px; width: 100%; }
        .rank-tag { background: var(--heroic-red); color: white; padding: 2px 10px; font-size: 11px; font-weight: 900; border-radius: 3px; box-shadow: 0 4px 10px rgba(214, 48, 49, 0.3); display: inline-flex; align-items: center; gap: 5px; }
        .player-name { font-size: 38px; font-weight: 900; color: #2d3436; margin: 5px 0; display: flex; align-items: center; gap: 10px; text-shadow: 1px 1px 0px white; }

        /* Tactical Orders */
        .commander-orders { background: #fff9e6; border: 2px solid var(--ff-gold); margin: 15px; padding: 15px; font-size: 12px; border-radius: 8px; color: #444; line-height: 1.6; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { border-color: var(--ff-gold); } 50% { border-color: #eee; } 100% { border-color: var(--ff-gold); } }

        .loot-card { background: var(--ff-card); margin: 0 15px 15px 15px; padding: 15px; border-radius: 12px; text-align: center; border: 1px solid #e0e0e0; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .bounty-amount { font-size: 40px; font-weight: 900; color: var(--ff-gold); display: block; }

        /* Date Controller */
        .date-shifter { display: flex; justify-content: space-between; align-items: center; background: #fff; margin: 0 15px 15px 15px; padding: 8px; border-radius: 8px; border: 1px solid #ddd; }
        .shift-btn { background: #f0f0f0; border: 1px solid #ddd; color: var(--ff-gold); width: 40px; height: 40px; border-radius: 5px; cursor: pointer; font-size: 18px; }
        .date-display { flex: 1; text-align: center; font-weight: 900; cursor: pointer; color: #2d3436; }

        /* Actions */
        .battle-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 0 15px 20px 15px; }
        .action-btn { padding: 15px; border: none; font-family: 'Cairo'; font-weight: 900; cursor: pointer; clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px); transition: transform 0.2s; }
        .action-btn:active { transform: scale(0.95); }
        .btn-booyah { background: var(--ff-gold); color: #fff; text-shadow: 0 1px 2px rgba(0,0,0,0.2); }
        .btn-defeat { background: #f0f0f0; color: #b2bec3; border: 1px solid #ddd; }

        /* Squad Radio (Chat) */
        .squad-radio-container { background: #fff; margin: 0 15px 20px 15px; border: 1px solid #ddd; border-radius: 10px; overflow: hidden; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .radio-header { background: #f8f9fa; padding: 8px 12px; font-size: 10px; font-weight: 900; color: var(--squad-blue); border-bottom: 1px solid #ddd; display: flex; align-items: center; gap: 5px; }
        .chat-box { height: 180px; overflow-y: auto; padding: 10px; background: #fff; display: flex; flex-direction: column; gap: 8px; }
        .msg { font-size: 12px; line-height: 1.4; padding: 6px 10px; border-radius: 6px; background: #f1f2f6; border-right: 3px solid transparent; color: #2d3436; }
        
        .msg-papa { border-right-color: var(--ff-gold); background: #fffdf2; }
        .msg-mama { border-right-color: var(--ammo-pink); background: #fdf2f7; }
        .msg-yassin { border-right-color: var(--squad-blue); background: #f2f7ff; }
        
        .role-tag { font-weight: 900; font-size: 9px; margin-left: 5px; padding: 1px 5px; border-radius: 3px; }
        .tag-papa { background: var(--ff-gold); color: #fff; }
        .tag-mama { background: var(--ammo-pink); color: #fff; }
        .tag-yassin { background: var(--squad-blue); color: #fff; }

        .chat-input-area { display: flex; background: #f8f9fa; padding: 8px; gap: 5px; border-top: 1px solid #eee; }
        .sender-select { background: #fff; border: 1px solid #ddd; font-size: 10px; border-radius: 4px; padding: 0 5px; }
        .msg-input { flex: 1; border: 1px solid #ddd; padding: 8px; font-size: 12px; border-radius: 4px; outline: none; }
        .btn-send { background: var(--ff-gold); border: none; padding: 0 15px; border-radius: 4px; cursor: pointer; color: white; }

        /* History Log */
        .battle-log { background: #fff; margin: 0 15px; border-radius: 10px; border: 1px solid #ddd; }
        .log-header { padding: 10px; font-size: 12px; color: var(--ff-gold); border-bottom: 1px solid #eee; display: flex; justify-content: space-between; font-weight: bold; }
        .log-list { max-height: 150px; overflow-y: auto; padding: 5px; }
        .log-entry { display: flex; justify-content: space-between; padding: 8px; font-size: 12px; border-bottom: 1px solid #f1f2f6; color: #636e72; }
        
        input[type="date"] { display: none; }
    </style>
</head>
<body>

<div class="battle-container">
    <div class="warrior-header">
        <div class="player-info">
            <span class="rank-tag">ğŸ† GRANDMASTER ğŸ–ï¸</span>
            <h1 class="player-name">ğŸ¥· Y.KARIZMA ğŸ”«</h1>
        </div>
    </div>

    <div class="commander-orders">
        âš ï¸ <b>Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© Ø§Ù„Ø¹Ù„ÙŠØ§:</b> <br>
        1ï¸âƒ£ Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰ <b>(1000Ø¬)</b> Ù…Ø¶Ù…ÙˆÙ†Ø© ÙÙŠ "Ø´Ù‡Ø± Ø§Ù„ØªØ¯Ø±ÙŠØ¨" ÙÙ‚Ø·.<br>
        2ï¸âƒ£ Ù…Ø³ØªÙ‚Ø¨Ù„Ø§Ù‹: Ø£ÙŠ Ù‡Ø²ÙŠÙ…Ø© ØªÙÙÙ‚Ø¯Ùƒ Ø§Ù„Ù€ 1000Ø¬ØŒ ÙˆÙŠØµØ¨Ø­ Ø­Ø³Ø§Ø¨Ùƒ <b>10Ø¬</b> Ù„Ù„ÙŠÙˆÙ… Ø§Ù„Ø¬Ø§Ù!<br>
        3ï¸âƒ£ Ø§Ù„Ù€ <b>1000Ø¬</b> ØªØ¹ÙˆØ¯ ÙÙ‚Ø· Ø¹Ù†Ø¯ Ø¥ØªÙ…Ø§Ù… <b>Ø§Ù„Ø´Ù‡Ø± ÙƒØ§Ù…Ù„Ø§Ù‹</b> Ø¯ÙˆÙ† Ø®Ø·Ø£! ğŸ”¥
    </div>

    <div class="loot-card">
        <span style="font-size: 11px; color: #888; font-weight: bold;">ğŸ’ STRATEGIC BOUNTY</span>
        <span class="bounty-amount" id="money">1000</span>
    </div>

    <div class="date-shifter">
        <button class="shift-btn" onclick="changeDay(-1)">â—€</button>
        <div class="date-display" onclick="document.getElementById('date-input').showPicker()">
            <div id="date-text">ğŸ“… ØªØ­Ù…ÙŠÙ„...</div>
            <div id="status-text" style="font-size:10px; color: #999;">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø±ØµØ¯</div>
        </div>
        <button class="shift-btn" onclick="changeDay(1)">â–¶</button>
        <input type="date" id="date-input" onchange="setDate(this.value)">
    </div>

    <div class="battle-actions">
        <button class="action-btn btn-booyah" id="win-btn" onclick="register(true)">BOOYAH!</button>
        <button class="action-btn btn-defeat" id="loss-btn" onclick="register(false)">DEFEAT</button>
    </div>

    <div class="squad-radio-container">
        <div class="radio-header">ğŸ“¡ SQUAD RADIO - Ø±Ø§Ø¯ÙŠÙˆ Ø§Ù„ÙƒØªÙŠØ¨Ø©</div>
        <div class="chat-box" id="chat-messages"></div>
        <div class="chat-input-area">
            <select id="sender-name" class="sender-select">
                <option value="Ø¨Ø§Ø¨Ø§">Ø¨Ø§Ø¨Ø§ (Commander)</option>
                <option value="Ù…Ø§Ù…Ø§">Ù…Ø§Ù…Ø§ (Supply)</option>
                <option value="ÙŠØ§Ø³ÙŠÙ†">Ø³Ù…Ø³Ù… (Veteran)</option>
            </select>
            <input type="text" id="msg-input" class="msg-input" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø© ØªÙƒØªÙŠÙƒÙŠØ©...">
            <button class="btn-send" onclick="sendMsg()">ğŸ“¡</button>
        </div>
    </div>

    <div class="battle-log">
        <div class="log-header"><span>ğŸ“œ Ø³Ø¬Ù„ Ø§Ù„Ù…Ù‡Ø§Ù…</span><span id="month-stat">0/0</span></div>
        <div class="log-list" id="history-log"></div>
    </div>
</div>

<script>
    // Ù†ÙØ³ ÙƒÙˆØ¯ Ø§Ù„Ù€ Firebase ÙˆØ§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠ ØªÙ…Ø§Ù…Ø§Ù‹ Ø¯ÙˆÙ† Ø£ÙŠ ØªØºÙŠÙŠØ±
    const firebaseConfig = {
        apiKey: "AIzaSyAPhrEzYnHoL3ln8_5BFFyWCjx2Y-G80E0",
        authDomain: "yassinapp-20262.firebaseapp.com",
        databaseURL: "https://yassinapp-20262-default-rtdb.firebaseio.com",
        projectId: "yassinapp-20262",
        storageBucket: "yassinapp-20262.firebasestorage.app",
        messagingSenderId: "940031861888",
        appId: "1:940031861888:web:9b7600cbf80b6343"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    let historyData = {};
    let activeDate = new Date();

    function sendMsg() {
        const sender = document.getElementById('sender-name').value;
        const text = document.getElementById('msg-input').value;
        if(!text) return;
        db.ref('squad_chat').push({ sender: sender, text: text, timestamp: Date.now() });
        document.getElementById('msg-input').value = '';
    }

    db.ref('squad_chat').limitToLast(15).on('value', (snap) => {
        const box = document.getElementById('chat-messages');
        box.innerHTML = '';
        snap.forEach(child => {
            const m = child.val();
            let roleClass = m.sender === 'Ø¨Ø§Ø¨Ø§' ? 'msg-papa' : (m.sender === 'Ù…Ø§Ù…Ø§' ? 'msg-mama' : 'msg-yassin');
            let tagClass = m.sender === 'Ø¨Ø§Ø¨Ø§' ? 'tag-papa' : (m.sender === 'Ù…Ø§Ù…Ø§' ? 'tag-mama' : 'tag-yassin');
            box.innerHTML += `<div class="msg ${roleClass}"><span class="role-tag ${tagClass}">${m.sender}</span> ${m.text}</div>`;
        });
        box.scrollTop = box.scrollHeight;
    });

    function updateDisplay() {
        const key = activeDate.toISOString().split('T')[0];
        const dateOptions = { weekday: 'long', day: 'numeric', month: 'long' };
        document.getElementById('date-text').innerText = "ğŸ“… " + activeDate.toLocaleDateString('ar-EG', dateOptions);
        const winBtn = document.getElementById('win-btn'), lossBtn = document.getElementById('loss-btn'), statusText = document.getElementById('status-text');
        if (historyData[key]) {
            winBtn.disabled = lossBtn.disabled = true;
            winBtn.style.opacity = lossBtn.style.opacity = "0.3";
            statusText.innerText = historyData[key] === 'dry' ? "âœ… ØªÙ… Ø§Ù„Ø±ØµØ¯: BOOYAH" : "âŒ ØªÙ… Ø§Ù„Ø±ØµØ¯: DEFEAT";
        } else {
            winBtn.disabled = lossBtn.disabled = false;
            winBtn.style.opacity = lossBtn.style.opacity = "1";
            statusText.innerText = "Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø±ØµØ¯ Ø§Ù„Ù…Ù‡Ù…Ø©...";
        }
    }

    function changeDay(delta) { activeDate.setDate(activeDate.getDate() + delta); updateDisplay(); }
    function setDate(val) { activeDate = new Date(val); updateDisplay(); }

    db.ref('yassin_money_quest/history').on('value', (snap) => {
        historyData = snap.val() || {};
        calculateBounty(); renderLog(); updateDisplay();
    });

    function calculateBounty() {
        let dry = 0, wet = 0, hasWet = false;
        Object.entries(historyData).forEach(([date, stat]) => {
            const d = new Date(date);
            if(d.getMonth() === activeDate.getMonth() && d.getFullYear() === activeDate.getFullYear()){
                if(stat === 'dry') dry++; else { wet++; hasWet = true; }
            }
        });
        const isJan26 = (activeDate.getFullYear() === 2026 && activeDate.getMonth() === 0);
        document.getElementById('money').innerText = isJan26 ? "1000" : (hasWet ? dry * 10 : 1000);
        document.getElementById('month-stat').innerText = `âœ… ${dry} | âŒ ${wet}`;
    }

    function renderLog() {
        const list = document.getElementById('history-log'); list.innerHTML = '';
        Object.entries(historyData).sort((a,b)=>b[0].localeCompare(a[0])).forEach(([date, stat]) => {
            const d = new Date(date);
            if(d.getMonth() === activeDate.getMonth()) {
                list.innerHTML += `<div class="log-entry"><span>${date}</span><b style="color:${stat==='dry'?'var(--success-green)':'var(--heroic-red)'}">${stat==='dry'?'BOOYAH':'DEFEAT'}</b></div>`;
            }
        });
    }

    function register(isDry) {
        const key = activeDate.toISOString().split('T')[0];
        if(historyData[key]) return;
        if(isDry) confetti({ particleCount: 100, spread: 70 });
        db.ref('yassin_money_quest/history').update({ [key]: isDry ? 'dry' : 'wet' });
    }

    document.getElementById('date-input').valueAsDate = new Date();
    updateDisplay();
</script>
</body>
</html>
