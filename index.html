<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø³ÙˆØ¨Ø± ÙŠØ§Ø³ÙŠÙ† - Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¨Ø·ÙˆÙ„ÙŠ</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        :root {
            --hero-blue: #2980b9;
            --hero-gold: #f1c40f;
            --hero-red: #c0392b;
            --bg-dark: #1a1a2e;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background: var(--bg-dark);
            display: flex;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 10px;
            color: #fff;
        }

        .app-card {
            background: #ffffff;
            border-radius: 50px;
            width: 100%;
            max-width: 440px;
            text-align: center;
            color: #2c3e50;
            border: 8px solid var(--hero-gold);
            box-shadow: 0 0 50px rgba(241, 196, 15, 0.3);
            overflow: hidden;
            position: relative;
        }

        /* Ø§Ù„Ø´Ø®ØµÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø§Ù„Ø¶Ø®Ù…Ø© */
        .hero-header {
            background: linear-gradient(to bottom, #000, #1a1a2e);
            padding: 50px 10px;
            border-bottom: 8px solid var(--hero-gold);
        }

        .hero-character {
            font-size: 140px; /* Ø­Ø¬Ù… Ø£ÙƒØ¨Ø± */
            display: inline-block;
            filter: drop-shadow(0 0 30px var(--hero-gold));
            animation: super-glow 2.5s infinite ease-in-out;
        }

        @keyframes super-glow {
            0% { transform: scale(1); filter: drop-shadow(0 0 20px var(--hero-gold)); }
            50% { transform: scale(1.15); filter: drop-shadow(0 0 50px #fff); }
            100% { transform: scale(1); filter: drop-shadow(0 0 20px var(--hero-gold)); }
        }

        .hero-name {
            font-size: 45px;
            font-weight: 900;
            color: var(--hero-gold);
            margin-top: 15px;
            text-shadow: 3px 3px 0px #000;
        }

        /* Ù…Ø±Ø¨Ø¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ */
        .monthly-report {
            background: #f0f3f5;
            margin: 15px;
            padding: 20px;
            border-radius: 30px;
            border: 2px solid #bdc3c7;
            text-align: right;
        }

        .report-title {
            font-weight: 900;
            color: var(--hero-blue);
            font-size: 20px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .report-item {
            font-size: 16px;
            margin: 5px 0;
            color: #34495e;
        }

        /* ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„ÙƒÙ†Ø² */
        .treasure-box {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            margin: 15px;
            padding: 25px;
            border-radius: 35px;
            color: white;
            box-shadow: 0 10px 20px rgba(39, 174, 96, 0.3);
        }

        .money-val {
            font-size: 55px;
            font-weight: 900;
            display: block;
        }

        .btn {
            width: 88%;
            padding: 22px;
            margin: 10px 0;
            border-radius: 30px;
            font-size: 24px;
            font-weight: 900;
            border: none;
            cursor: pointer;
            color: white;
            transition: 0.2s;
        }

        .btn-dry { background: #2980b9; border-bottom: 8px solid #1c5982; }
        .btn-wet { background: #95a5a6; border-bottom: 8px solid #7f8c8d; }

        .btn:active { transform: translateY(4px); border-bottom-width: 2px; }

        .chat-section {
            background: #f8f9fa;
            padding: 20px;
            border-top: 4px solid var(--hero-gold);
        }

        .messages {
            height: 100px;
            background: white;
            border-radius: 15px;
            padding: 10px;
            overflow-y: auto;
            border: 1px solid #ddd;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

<div class="app-card">
    <div class="hero-header">
        <div class="hero-character">ğŸ‘¦âš¡</div>
        <div class="hero-name">Ø³ÙˆØ¨Ø± ÙŠØ§Ø³ÙŠÙ†</div>
    </div>

    <div class="monthly-report">
        <div class="report-title">ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¨Ø·Ù„ Ø§Ù„Ø´Ù‡Ø±ÙŠ</div>
        <div class="report-item">ğŸ–ï¸ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø£Ø¯Ø§Ø¡: <span id="performance-rank" style="font-weight:900;">Ø¨Ø·Ù„ ØµØ§Ø¹Ø¯</span></div>
        <div class="report-item">ğŸ¯ Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­: <span id="success-rate">0%</span></div>
        <div class="report-item">ğŸ’¡ Ù†ØµÙŠØ­Ø© Ø³ÙˆØ¨Ø±: <span id="hero-tip" style="color:var(--hero-red); font-weight:bold;">Ø§Ø³ØªØ¹Ø¯ Ù„Ù„Ù…Ø¹Ø±ÙƒØ© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©!</span></div>
    </div>

    <div class="treasure-box">
        <span style="font-weight: bold; font-size: 20px;">ğŸ’° Ø±ØµÙŠØ¯ Ø§Ù„ÙƒÙ†Ø² Ø§Ù„Ø­Ø§Ù„ÙŠ:</span>
        <span class="money-val" id="money">0 Ø¬Ù†ÙŠÙ‡</span>
        <small id="note" style="font-weight: bold;"></small>
    </div>

    <input type="date" id="date" style="padding:15px; border-radius:15px; border:2px solid var(--hero-gold); font-size: 20px; width: 80%; margin-bottom: 10px;">

    <button class="btn btn-dry" onclick="save(true)">âš¡ Ù„ÙŠÙ„Ø© Ø¨Ø·Ù„ Ù‚ÙˆÙŠØ©</button>
    <button class="btn btn-wet" onclick="save(false)">ğŸŒ§ï¸ Ù…Ø­Ø§ÙˆÙ„Ø© Ø£Ø®Ø±Ù‰ Ù„Ù„Ù‚Ù…Ø©</button>

    <div class="chat-section">
        <div style="font-weight: 900; color: var(--hero-blue); margin-bottom: 8px;">ğŸ’¬ Ù…Ø±ÙƒØ² Ù‚ÙŠØ§Ø¯Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</div>
        <div class="messages" id="chat"></div>
        <div style="display: flex; gap: 5px;">
            <input type="text" id="msg" placeholder="Ø´Ø¬Ø¹ ÙŠØ§Ø³ÙŠÙ†..." style="flex:1; padding:10px; border-radius:10px; border:1px solid #ccc;">
            <button onclick="send()" style="background:var(--hero-blue); color:white; border:none; padding:10px 15px; border-radius:10px;">Ø¥Ø±Ø³Ø§Ù„</button>
        </div>
    </div>
</div>

<script>
    const config = {
        apiKey: "AIzaSyAPhrEzYnHoL3ln8_5BFFyWCjx2Y-G80E0",
        authDomain: "yassinapp-20262.firebaseapp.com",
        databaseURL: "https://yassinapp-20262-default-rtdb.firebaseio.com",
        projectId: "yassinapp-20262",
        storageBucket: "yassinapp-20262.firebasestorage.app",
        messagingSenderId: "940031861888",
        appId: "1:940031861888:web:9b7600cbf80b6343"
    };
    firebase.initializeApp(config);
    const db = firebase.database();
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('date').valueAsDate = new Date();

    db.ref('yassin_money_quest').on('value', (s) => {
        const data = s.val() || { history: {} };
        const entries = Object.entries(data.history);
        let dry = 0, wetCount = 0;
        
        entries.forEach(([d, status]) => { 
            if(status === 'dry') dry++;
            else wetCount++;
        });

        // Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„ØªÙ‚Ø±ÙŠØ±
        const total = entries.length;
        const rate = total > 0 ? Math.round((dry / total) * 100) : 0;
        
        document.getElementById('success-rate').innerText = rate + "%";
        document.getElementById('money').innerText = (wetCount > 0 ? (dry * 10) : (total > 0 ? 1000 : 0)) + " Ø¬Ù†ÙŠÙ‡";
        
        if(rate >= 90) {
            document.getElementById('performance-rank').innerText = "Ø¨Ø·Ù„ Ø£Ø³Ø·ÙˆØ±ÙŠ ğŸ‘‘";
            document.getElementById('hero-tip').innerText = "Ø£Ù†Øª Ù…Ø°Ù‡Ù„! Ø§Ø³ØªÙ…Ø± Ù‡ÙƒØ°Ø§.";
        } else if(rate >= 70) {
            document.getElementById('performance-rank').innerText = "Ø¨Ø·Ù„ Ø®Ø§Ø±Ù‚ âš¡";
            document.getElementById('hero-tip').innerText = "Ø£Ø¯Ø§Ø¡ Ù‚ÙˆÙŠ Ø¬Ø¯Ø§Ù‹ ÙŠØ§ ÙŠØ§Ø³ÙŠÙ†!";
        } else {
            document.getElementById('performance-rank').innerText = "Ø¨Ø·Ù„ Ù…ÙƒØ§ÙØ­ ğŸ’ª";
            document.getElementById('hero-tip').innerText = "Ø­Ø§ÙˆÙ„ Ø£ÙƒØ«Ø± Ù„ØªØµØ¨Ø­ Ø£Ù‚ÙˆÙ‰!";
        }
        
        document.getElementById('note').innerText = wetCount > 0 ? "Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø°ÙƒÙŠ Ù…ÙØ¹Ù„" : "Ø¨Ø·Ù„ Ø§Ù„Ø´Ù‡Ø± Ø§Ù„ÙƒØ§Ù…Ù„: 1000Ø¬";
    });

    db.ref('yassin_chat').on('value', (s) => {
        const chatBox = document.getElementById('chat');
        chatBox.innerHTML = '';
        Object.values(s.val() || {}).forEach(m => {
            if(m.date === today) chatBox.innerHTML += `<div><b>Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©:</b> ${m.text}</div>`;
        });
        chatBox.scrollTop = chatBox.scrollHeight;
    });

    function save(isDry) {
        const d = document.getElementById('date').value;
        db.ref('yassin_money_quest/history').update({ [d]: isDry ? 'dry' : 'wet' });
    }

    function send() {
        const t = document.getElementById('msg').value;
        if(!t) return;
        db.ref('yassin_chat').push({ text: t, date: today });
        document.getElementById('msg').value = '';
    }
</script>
</body>
</html>
